<!DOCTYPE html>
<html lang="ko">
<head>
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ì—°ìˆ˜ ì¶œì„">
<link rel="icon" sizes="192x192" href="icon-192.png"> <link rel="apple-touch-icon" href="icon-192.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ìˆ˜ ì¶œì„ ì²´í¬ ì‹œìŠ¤í…œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            background: none;
            font-size: 16px;
        }
        
        .tab:hover {
            background: #e9ecef;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }
        
        .content {
            padding: 30px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .control-panel label {
            font-weight: bold;
            color: #495057;
        }
        
        .control-panel select {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
        
        .teacher-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .teacher-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .teacher-card.present {
            background: #d4edda;
            border-color: #28a745;
        }
        
        .teacher-card.absent {
            background: #f8d7da;
            border-color: #dc3545;
        }
        
        .teacher-card .name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
            color: #212529;
        }
        
        .teacher-card .status {
            font-size: 14px;
            color: #6c757d;
        }
        
        .teacher-card.present .status {
            color: #28a745;
            font-weight: bold;
        }
        
        .teacher-card.absent .status {
            color: #dc3545;
            font-weight: bold;
        }
        
        .summary {
            background: #e7f3ff;
            border: 2px solid #0066cc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-item .label {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 5px;
        }
        
        .summary-item .value {
            font-size: 32px;
            font-weight: bold;
            color: #0066cc;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .attendance-table th,
        .attendance-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: center;
        }
        
        .attendance-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .attendance-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .attendance-table tr:hover {
            background: #e9ecef;
        }
        
        .status-present {
            color: #28a745;
            font-weight: bold;
        }
        
        .status-absent {
            color: #dc3545;
            font-weight: bold;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #495057;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .teacher-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .teacher-tag {
            background: #e7f3ff;
            border: 1px solid #0066cc;
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .teacher-tag button {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 12px;
            line-height: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ ì—°ìˆ˜ ì¶œì„ ì²´í¬ ì‹œìŠ¤í…œ</h1>
            <p>ê°„í¸í•˜ê³  ì •í™•í•œ ì¶œì„ ê´€ë¦¬</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('attendance')">ì¶œì„ ì²´í¬</button>
            <button class="tab" onclick="showTab('status')">ì¶œì„ í˜„í™©</button>
            <button class="tab" onclick="showTab('settings')">ì„¤ì •</button>
        </div>
        
        <div class="content">
            <div id="attendance" class="tab-content active">
                <div class="control-panel">
                    <div>
                        <label>ë‚ ì§œ:</label>
<input type="date" id="daySelect" onchange="updateAttendance()">
                    </div>
                    <div>
                        <label>êµì‹œ:</label>
                        <select id="periodSelect" onchange="updateAttendance()">
                            <option value="1">1êµì‹œ</option>
                            <option value="2">2êµì‹œ</option>
                            <option value="3">3êµì‹œ</option>
                            <option value="4">4êµì‹œ</option>
                        </select>
                    </div>
                </div>
                
                <div class="summary">
                    <div class="summary-item">
                        <div class="label">ì¶œì„</div>
                        <div class="value" id="presentCount">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="label">ê²°ì„</div>
                        <div class="value" id="absentCount" style="color: #dc3545;">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="label">ë¯¸ì²´í¬</div>
                        <div class="value" id="uncheckedCount" style="color: #ffc107;">18</div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-success" onclick="markAllPresent()">âœ“ ì „ì²´ ì¶œì„</button>
                    <button class="btn btn-danger" onclick="markAllAbsent()">âœ— ì „ì²´ ê²°ì„</button>
                    <button class="btn btn-warning" onclick="clearCurrentPeriod()">ğŸ”„ í˜„ì¬ êµì‹œ ì´ˆê¸°í™”</button>
                </div>
                
                <div class="teacher-grid" id="teacherGrid"></div>
            </div>
            
            <div id="status" class="tab-content">
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-success" onclick="exportToExcel()">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
                </div>
                
                <div id="statusTable"></div>
            </div>
            
            <div id="settings" class="tab-content">
                <h2 style="margin-bottom: 20px;">êµì‚¬ ëª…ë‹¨ ê´€ë¦¬</h2>
                
                <div class="input-group">
                    <label>êµì‚¬ ì´ë¦„ ì¶”ê°€:</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="newTeacherName" placeholder="êµì‚¬ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                        <button class="btn btn-primary" onclick="addTeacher()">ì¶”ê°€</button>
                    </div>
                </div>
                
                <div class="teacher-list" id="teacherList"></div>
                
                <div style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                    <h3 style="margin-bottom: 15px;">êµì‚¬ ì´ë¦„ ìˆ˜ì •</h3>
                    <div class="input-group">
                        <label>ìˆ˜ì •í•  êµì‚¬ ì„ íƒ:</label>
                        <select id="editTeacherSelect" style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 16px;">
                            <option value="">-- êµì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš” --</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>ìƒˆ ì´ë¦„:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="editTeacherName" placeholder="ìƒˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                            <button class="btn btn-primary" onclick="editTeacher()">ìˆ˜ì •</button>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #dee2e6;">
                    <button class="btn btn-danger" onclick="resetAllData()">
                        ğŸ”„ ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
                    </button>
                    <p style="margin-top: 10px; color: #6c757d; font-size: 14px;">
                        âš ï¸ ëª¨ë“  ì¶œì„ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•˜ì„¸ìš”.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let attendanceData = {};

        function initializeData() {
            const savedTeachers = JSON.parse(localStorage.getItem('teachers') || '[]');
            if (savedTeachers.length > 0) {
                teachers = savedTeachers;
            } else {
                teachers = Array.from({length: 18}, (_, i) => `êµì‚¬${i + 1}`);
                saveTeachers();
            }
            
            const savedAttendance = localStorage.getItem('attendanceData');
            if (savedAttendance) {
                attendanceData = JSON.parse(savedAttendance);
            } else {
                attendanceData = {};
            }
        }

        function saveTeachers() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
        }

        function saveAttendance() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
        }

        function getAttendanceKey() {
            const day = document.getElementById('daySelect').value;
            const period = document.getElementById('periodSelect').value;
            return `day${day}_period${period}`;
        }

        function toggleAttendance(teacherName) {
            const key = getAttendanceKey();
            if (!attendanceData[key]) {
                attendanceData[key] = {};
            }
            
            if (attendanceData[key][teacherName] === 'present') {
                attendanceData[key][teacherName] = 'absent';
            } else if (attendanceData[key][teacherName] === 'absent') {
                delete attendanceData[key][teacherName];
            } else {
                attendanceData[key][teacherName] = 'present';
            }
            
            saveAttendance();
            updateAttendance();
        }

        function updateAttendance() {
            const key = getAttendanceKey();
            const grid = document.getElementById('teacherGrid');
            grid.innerHTML = '';
            
            let presentCount = 0;
            let absentCount = 0;
            let uncheckedCount = 0;
            
            teachers.forEach(teacher => {
                const card = document.createElement('div');
                card.className = 'teacher-card';
                
                const status = attendanceData[key]?.[teacher];
                if (status === 'present') {
                    card.classList.add('present');
                    presentCount++;
                } else if (status === 'absent') {
                    card.classList.add('absent');
                    absentCount++;
                } else {
                    uncheckedCount++;
                }
                
                card.innerHTML = `
                    <div class="name">${teacher}</div>
                    <div class="status">
                        ${status === 'present' ? 'âœ“ ì¶œì„' : status === 'absent' ? 'âœ— ê²°ì„' : 'ë¯¸ì²´í¬'}
                    </div>
                `;
                
                card.onclick = () => toggleAttendance(teacher);
                grid.appendChild(card);
            });
            
            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('absentCount').textContent = absentCount;
            document.getElementById('uncheckedCount').textContent = uncheckedCount;
        }

        function markAllPresent() {
            const key = getAttendanceKey();
            if (!attendanceData[key]) {
                attendanceData[key] = {};
            }
            
            teachers.forEach(teacher => {
                attendanceData[key][teacher] = 'present';
            });
            
            saveAttendance();
            updateAttendance();
        }

        function markAllAbsent() {
            const key = getAttendanceKey();
            if (!attendanceData[key]) {
                attendanceData[key] = {};
            }
            
            teachers.forEach(teacher => {
                attendanceData[key][teacher] = 'absent';
            });
            
            saveAttendance();
            updateAttendance();
        }

        function clearCurrentPeriod() {
            const day = document.getElementById('daySelect').value;
            const period = document.getElementById('periodSelect').value;
            
            if (confirm(`${day}ì¼ì°¨ ${period}êµì‹œì˜ ì¶œì„ ë°ì´í„°ë¥¼ ëª¨ë‘ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                const key = getAttendanceKey();
                delete attendanceData[key];
                saveAttendance();
                updateAttendance();
                alert('ì´ˆê¸°í™” ì™„ë£Œ!');
            }
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'status') {
                updateStatusTable();
            } else if (tabName === 'settings') {
                updateTeacherList();
            }
        }

        
function updateStatusTable() {
    const table = document.getElementById('statusTable');
    const allKeys = Object.keys(attendanceData || {});
    // collect keys that match pattern day{date}_period{number}
    const entries = allKeys.map(k => {
        const m = k.match(/^day(.+)_period(\d+)$/);
        if (m) return {date: m[1], period: Number(m[2]), key: k};
        return null;
    }).filter(Boolean);

    if (entries.length === 0) {
        table.innerHTML = '<p style="color: gray;">ì•„ì§ ì €ì¥ëœ ì¶œì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
    }

    // group by date then sort by date and period
    entries.sort((a,b) => {
        if (a.date < b.date) return -1;
        if (a.date > b.date) return 1;
        return a.period - b.period;
    });

    // unique entries by date+period
    const keyList = [];
    const seen = new Set();
    for (const e of entries) {
        const id = e.date + '|' + e.period;
        if (!seen.has(id)) {
            seen.add(id);
            keyList.push({date: e.date, period: e.period});
        }
    }

    // header
    let html = '<table class="attendance-table"><thead><tr><th>êµì‚¬ëª…</th>';
    keyList.forEach(({date, period}) => {
        let displayDate = date;
        // if date matches yyyy-mm-dd convert to mm/dd, else leave as is
        const m = String(date).match(/^(\d{4})-(\d{2})-(\d{2})$/);
        if (m) displayDate = m[2] + '/' + m[3]; else if (/^\d+$/.test(date)) displayDate = date + 'ì¼ì°¨';
        html += `<th>${displayDate}<br>${period}êµì‹œ</th>`;
    });
    html += '<th>ì¶œì„ë¥ </th></tr></thead><tbody>';

    // rows
    teachers.forEach(teacher => {
        html += `<tr><td><strong>${teacher}</strong></td>`;
        let totalPresent = 0;
        let total = 0;
        keyList.forEach(({date, period}) => {
            const key = `day${date}_period${period}`;
            const status = (attendanceData[key] || {})[teacher];
            total++;
            if (status === 'present') {
                html += '<td class="status-present">ì¶œì„</td>';
                totalPresent++;
            } else if (status === 'absent') {
                html += '<td class="status-absent">ê²°ì„</td>';
            } else {
                html += '<td>-</td>';
            }
        });
        const rate = total > 0 ? Math.round((totalPresent / total) * 100) : 0;
        html += `<td><strong>${rate}%</strong></td></tr>`;
    });

    html += '</tbody></table>';
    table.innerHTML = html;
}


        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const data = [['êµì‚¬ëª…']];

            // 1. ëª¨ë“  ì¶œì„ ë°ì´í„° í‚¤ ìˆ˜ì§‘ ë° ì •ë ¬
            const allKeys = Object.keys(attendanceData || {});
            const entries = allKeys.map(k => {
                const m = k.match(/^day(.+)_period(\d+)$/);
                if (m) return {date: m[1], period: Number(m[2]), key: k};
                return null;
            }).filter(Boolean);

            if (entries.length === 0) {
                alert('ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œí•  ì¶œì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë‚ ì§œ ë° êµì‹œ ìˆœì„œë¡œ ì •ë ¬
            entries.sort((a,b) => {
                if (a.date < b.date) return -1;
                if (a.date > b.date) return 1;
                return a.period - b.period;
            });

            // ê³ ìœ í•œ ë‚ ì§œ+êµì‹œ ì¡°í•©ë§Œ ì¶”ì¶œ (ì¤‘ë³µ ë°©ì§€)
            const keyList = [];
            const seen = new Set();
            for (const e of entries) {
                const id = e.date + '|' + e.period;
                if (!seen.has(id)) {
                    seen.add(id);
                    keyList.push(e);
                }
            }

            // 2. í—¤ë” ìƒì„± (ë‚ ì§œì™€ êµì‹œ)
            keyList.forEach(({date, period}) => {
                let displayDate = date;
                // ë‚ ì§œ í˜•ì‹ ë³€í™˜ (YYYY-MM-DD -> MM/DD, ìˆ«ìë§Œ ìˆìœ¼ë©´ 'ì¼ì°¨')
                const m = String(date).match(/^(\d{4})-(\d{2})-(\d{2})$/);
                if (m) displayDate = m[2] + '/' + m[3]; else if (/^\d+$/.test(date)) displayDate = date + 'ì¼ì°¨';

                data[0].push(`${displayDate} ${period}êµì‹œ`);
            });
            data[0].push('ì¶œì„ë¥ ');

            // 3. êµì‚¬ë³„ ì¶œì„ ë°ì´í„° í–‰ ìƒì„±
            teachers.forEach(teacher => {
                const row = [teacher];
                let totalPresent = 0;
                let total = 0;

                keyList.forEach(({key}) => {
                    const status = attendanceData[key]?.[teacher];
                    total++;

                    if (status === 'present') {
                        row.push('ì¶œì„');
                        totalPresent++;
                    } else if (status === 'absent') {
                        row.push('ê²°ì„');
                    } else {
                        row.push('-'); // ë¯¸ì²´í¬
                    }
                });

                // ì¶œì„ë¥  ê³„ì‚°
                const rate = total > 0 ? Math.round((totalPresent / total) * 100) : 0;
                row.push(`${rate}%`);
                data.push(row);
            });

            // 4. ì—‘ì…€ íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, 'ì¶œì„í˜„í™©');

            const today = new Date().toISOString().split('T')[0].replace(/-/g, ''); // yyyymmdd í˜•ì‹
            XLSX.writeFile(wb, `ì—°ìˆ˜ì¶œì„í˜„í™©_${today}.xlsx`);
        }

        function addTeacher() {
            const input = document.getElementById('newTeacherName');
            const name = input.value.trim();
            
            if (name && !teachers.includes(name)) {
                teachers.push(name);
                saveTeachers();
                input.value = '';
                updateTeacherList();
                updateAttendance();
                alert(`${name} êµì‚¬ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            } else if (teachers.includes(name)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” êµì‚¬ëª…ì…ë‹ˆë‹¤.');
            }
        }

        function removeTeacher(name) {
            if (confirm(`${name} êµì‚¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                teachers = teachers.filter(t => t !== name);
                saveTeachers();
                updateTeacherList();
                updateAttendance();
            }
        }

        function updateTeacherList() {
            const list = document.getElementById('teacherList');
            list.innerHTML = '';
            
            teachers.forEach(teacher => {
                const tag = document.createElement('div');
                tag.className = 'teacher-tag';
                tag.innerHTML = `
                    <span>${teacher}</span>
                    <button onclick="removeTeacher('${teacher}')">Ã—</button>
                `;
                list.appendChild(tag);
            });
            
            const editSelect = document.getElementById('editTeacherSelect');
            editSelect.innerHTML = '<option value="">-- êµì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš” --</option>';
            teachers.forEach(teacher => {
                const option = document.createElement('option');
                option.value = teacher;
                option.textContent = teacher;
                editSelect.appendChild(option);
            });
        }

        function editTeacher() {
            const select = document.getElementById('editTeacherSelect');
            const oldName = select.value;
            const newName = document.getElementById('editTeacherName').value.trim();
            
            if (!oldName) {
                alert('ìˆ˜ì •í•  êµì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }
            
            if (!newName) {
                alert('ìƒˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            if (teachers.includes(newName) && oldName !== newName) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” êµì‚¬ëª…ì…ë‹ˆë‹¤.');
                return;
            }
            
            const index = teachers.indexOf(oldName);
            if (index !== -1) {
                teachers[index] = newName;
                saveTeachers();
                
                Object.keys(attendanceData).forEach(key => {
                    if (attendanceData[key][oldName]) {
                        attendanceData[key][newName] = attendanceData[key][oldName];
                        delete attendanceData[key][oldName];
                    }
                });
                saveAttendance();
                
                document.getElementById('editTeacherName').value = '';
                updateTeacherList();
                updateAttendance();
                alert(`${oldName}ì˜ ì´ë¦„ì´ ${newName}(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        function resetAllData() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ì¶œì„ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                attendanceData = {};
                saveAttendance();
                updateAttendance();
                updateStatusTable();
                alert('ëª¨ë“  ì¶œì„ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        initializeData();
        updateAttendance();
    </script>
</body>
</html>